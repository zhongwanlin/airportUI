(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45d5eb98"],{"674d":function(e,t,a){},7581:function(e,t,a){"use strict";var i=a("674d"),s=a.n(i);s.a},b9e9:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"searchWrap"},[a("div",{staticClass:"search"},[a("table",[a("tr",[a("td",[e._v("\n                          用户名:\n                        "),[a("Input",{staticStyle:{width:"100px"},attrs:{clearable:"",placeholder:"请输入用户名"},model:{value:e.searchInfo.userName,callback:function(t){e.$set(e.searchInfo,"userName",t)},expression:"searchInfo.userName"}})],[a("div",{staticClass:"searchBtnList"},[a("Button",{attrs:{type:"primary",icon:"ios-add-circle"},on:{click:e.showNew}},[e._v("新增")]),a("Button",{attrs:{icon:"ios-refresh-circle"},on:{click:e.reflesh}},[e._v("重置")])],1)]],2)])])])]),a("div",{staticClass:"tableList"},[[a("Table",{attrs:{height:e.height-100,border:"",stripe:"",loading:e.isLoading,columns:e.columnsRealTime,data:e.realTimeDataList},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.row;t.index;return[a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showEdit(i)}}},[e._v("修改")]),e._v("  \n                    "),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(t){return e.deleteAction(i)}}},[e._v("删除")])]}},{key:"status",fn:function(t){var i=t.row;t.index;return[[a("i-switch",{attrs:{size:"large",value:i.status,"true-value":911,"false-value":912}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("启用")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("禁用")])])]]}}])})]],2),a("div",{staticClass:"pageWrap"},[[a("Page",{attrs:{total:e.count,"page-size":50,"page-size-opts":[50,100,150],"show-sizer":"",showTotal:""},on:{"on-change":e.pageSizeChange,"on-page-size-change":e.pageRowChange}})]],2),[a("Modal",{staticClass:"noContentPadding noHeaderModal",attrs:{"mask-closable":!1,width:"30",styles:{top:"5%"},title:"新增/修改账号"},on:{"on-cancel":function(t){e.isDetail=!1}},model:{value:e.isDetail,callback:function(t){e.isDetail=t},expression:"isDetail"}},[a("div",{staticClass:"modalTable"},[a("div",{staticClass:"detail",style:{maxHeight:e.height-200+"px",overflowY:"auto"}},[a("table",[a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("用户名：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写用户名,可由英文字母、数字组成"},model:{value:e.itemInfo.userName,callback:function(t){e.$set(e.itemInfo,"userName",t)},expression:"itemInfo.userName"}})],1),a("div",{staticClass:"tips"},[e._v("必填，可由英文字母、数字组成")])])]),a("tr",[a("td",[e._v("\n                                昵称：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写昵称,可以是中文"},model:{value:e.itemInfo.userName,callback:function(t){e.$set(e.itemInfo,"userName",t)},expression:"itemInfo.userName"}})],1),a("div",{staticClass:"tips"},[e._v("可以是中文")])])]),a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("密码：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写登录密码,至少6个字符,最多18个字符"},model:{value:e.itemInfo.userPwd,callback:function(t){e.$set(e.itemInfo,"userPwd",t)},expression:"itemInfo.userPwd"}})],1),a("div",{staticClass:"tips"},[e._v("必填，至少6个字符,最多18个字符")])])]),a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("角色：\n                                "),a("div",[[a("Select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"选择角色"},model:{value:e.itemInfo.roleIds,callback:function(t){e.$set(e.itemInfo,"roleIds",t)},expression:"itemInfo.roleIds"}},[e._l(e.roleList,(function(t,i){return[a("Option",{key:i,attrs:{value:t.id}},[e._v(e._s(t.roleName))])]}))],2)]],2),a("div",{staticClass:"tips"},[e._v("非超级管理员，禁止创建与当前角色同级的用户")])])]),a("tr",[a("td",[e._v("\n                                手机号码：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"手机号码"},model:{value:e.itemInfo.mobile,callback:function(t){e.$set(e.itemInfo,"mobile",t)},expression:"itemInfo.mobile"}})],1)])]),a("tr",[a("td",[e._v("\n                                邮箱：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"常用邮箱"},model:{value:e.itemInfo.email,callback:function(t){e.$set(e.itemInfo,"email",t)},expression:"itemInfo.email"}})],1)])]),a("tr",[a("td",[e._v("\n                                头像：\n                                "),a("div",[[a("Upload",{attrs:{action:"//jsonplaceholder.typicode.com/posts/"}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[e._v("上传单张图片")])],1)]],2)])]),a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("帐号状态：\n                                "),a("div",[a("RadioGroup",[a("Radio",{attrs:{label:"0"}},[e._v("禁用")]),a("Radio",{attrs:{label:"1"}},[e._v("启用")])],1)],1)])])])])]),a("div",{staticClass:"modalFooter",attrs:{slot:"footer"},slot:"footer"},[[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"default"},on:{click:function(t){e.isDetail=!1}}},[e._v("关闭")]),a("Button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.saveAction}},[e._v("提交")])]],2)])]],2)},s=[],o={name:"user",components:{},data:function(){return{userInfo:null,userFuncInfo:null,height:window.innerHeight,isDetail:!1,disable:!1,isLoading:!1,userFuncCode:{},count:0,pageInfo:{pageIndex:1,pageSize:50},searchInfo:{companyId:"",paraDeptIds:[],userCode:"",userName:""},itemInfo:{id:"",userCode:"",areaCode:"",userPwd:"",companyId:"",posiName:"员工",posiType:143,userName:"",mobile:"",email:"",status:"",paraDeptIds:[],roleIds:"",deptId:"",createUserId:"",modifyUserId:""},columnsRealTime:[{align:"center",title:"序号",type:"index",width:60},{title:"账号名",align:"center",key:"userCode"},{title:"姓名",align:"center",key:"userName"},{title:"手机号",align:"center",key:"mobile"},{title:"邮箱",align:"center",key:"email"},{title:"角色",align:"center",key:"roleNames"},{title:"状态",align:"center",key:"status",slot:"status"},{title:"创建时间",align:"center",key:"createTime"},{align:"center",title:"操作",width:120,slot:"action"}],realTimeDataList:[],companyList:[],superiorDepartmentList:[],userStatusType:[{name:"正常",type:911},{name:"冻结",type:912},{name:"作废",type:913}],roleList:[]}},watch:{"itemInfo.companyId":function(){var e=this;e.getRoleList(),e.$utility.getSuperiorDepartmentList(e,"itemInfo","deptId")},"searchInfo.companyId":function(){var e=this;e.$utility.getSuperiorDepartmentList(e,"searchInfo","deptId")}},methods:{pageSizeChange:function(e){var t=this;t.pageInfo.pageIndex=parseInt(e,10),t.getList(!0)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),t.getList(!1)},reflesh:function(){var e=this;e.getList(!0)},getCompanyList:function(){var e=this;e.axios({method:"post",headers:e.$utility.setHeader(e.$config.service.companyService),url:e.$config.action.getCompanyList,data:e.$qs.stringify({pageNum:1,pageSize:1e3})}).then((function(t){"200"==t.data.code?(e.companyList=t.data.data,e.searchInfo.companyId=e.companyList[0]?e.companyList[0]["id"]:""):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.message)})).catch((function(e){console.log(e)}))},getRoleList:function(e){var t=this;t.axios({method:"post",headers:t.$utility.setHeader(t.$config.service.permissionService),url:t.$config.action.getRoleList,data:t.$qs.stringify({pageNum:0,pageSize:1e4,companyId:t.itemInfo.companyId})}).then((function(e){"200"==e.data.code?t.roleList=e.data.data:"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.message),t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},getList:function(e){var t=this;1==e&&(t.isLoading=!0,t.pageInfo.pageIndex=0),t.axios({method:"post",headers:t.$utility.setHeader(t.$config.service.userService),url:t.$config.action.getUserList,data:t.$qs.stringify({pageNum:t.pageInfo.pageIndex,pageSize:t.pageInfo.pageSize,companyId:t.searchInfo.companyId,userCode:encodeURI(t.searchInfo.userCode),userName:encodeURI(t.searchInfo.userName),deptId:t.searchInfo.paraDeptIds[t.searchInfo.paraDeptIds.length-1]})}).then((function(e){"200"==e.data.code?(t.realTimeDataList=e.data.data,t.count=e.data.count):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.message),t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},showNew:function(){var e=this;e.itemInfo={id:"",areaCode:"",userCode:"",userPwd:"",companyId:"",userSeq:"",userName:"",mobile:"",email:"",status:"",paraDeptIds:[],roleIds:"",deptId:"",createUserId:"",modifyUserId:""},e.itemInfo.companyId=e.companyList[0]?e.companyList[0]["id"]:"",e.isDetail=!0},showEdit:function(e){var t=this;for(var a in e)t.itemInfo[a]=e[a];t.itemInfo["roleIds"]=parseInt(e["roleIds"],10),t.isDetail=!0,t.$utility.getSuperiorDepartmentList(t,"itemInfo","deptId")},showInfo:function(e){var t=this;for(var a in e)t.itemInfo[a]=e[a];t.isInfo=!0},saveAction:function(){var e=this;e.itemInfo.companyId?0!=e.itemInfo.paraDeptIds.length?0!=e.itemInfo.areaCode.length?e.itemInfo.userCode.trim().length<2||e.itemInfo.userCode.trim().length>50?e.$Message.error("用户账号至少2到50位字符"):0!=e.itemInfo.userName.trim().length?e.itemInfo.status?e.itemInfo.id||!(e.itemInfo.userPwd.trim().length<6||e.itemInfo.userPwd.trim().length>18)?""!==e.itemInfo.roleIds?(e.disable=!0,e.axios({method:"post",headers:e.$utility.setHeader(e.$config.service.userService),url:e.$config.action.saveUser,data:e.$qs.stringify({id:e.itemInfo.id||"",userCode:encodeURI(e.itemInfo.userCode),areaCode:encodeURI(e.itemInfo.areaCode),userPwd:e.itemInfo.userPwd,companyId:e.itemInfo.companyId,userName:encodeURI(e.itemInfo.userName),mobile:e.itemInfo.mobile,email:e.itemInfo.email,status:e.itemInfo.status,roleIds:e.itemInfo.roleIds,deptId:e.itemInfo.paraDeptIds[e.itemInfo.paraDeptIds.length-1],posiName:encodeURI("员工"),posiType:143,createUserId:e.userInfo["id"],modifyUserId:e.userInfo["id"]})}).then((function(t){"200"==t.data.code?(e.$Message.success("提交成功"),e.getList(!1),e.isDetail=!1,e.itemInfo={id:"",userCode:"",areaCode:"",userPwd:"",companyId:"",userSeq:"",userName:"",mobile:"",email:"",status:"",paraDeptIds:[],roleIds:"",roleIdList:[],deptId:"",createUserId:"",modifyUserId:""}):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.message),e.disable=!1})).catch((function(t){console.log(t),e.disable=!1}))):e.$Message.error("请选择角色"):e.$Message.error("登录密码至少6到18位字符"):e.$Message.error("请选择用户状态"):e.$Message.error("请输入用户名称"):e.$Message.error("请选择所在航站楼"):e.$Message.error("请选择部门"):e.$Message.error("请选择一家公司")},deleteAction:function(e){var t=this;t.$Modal.confirm({title:"确定删除"+e.userName+"?",onOk:function(){t.axios({method:"post",headers:t.$utility.setHeader(t.$config.service.userService),url:t.$config.action.delUser,data:t.$qs.stringify({ids:e.id,modifyUserId:t.userInfo["id"]})}).then((function(e){"200"==e.data.code?(t.$Message.success("删除成功"),t.getList(!0)):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.message)})).catch((function(e){console.log(e)}))}})}},created:function(){var e=this,t=null;e.userInfo=e.$utility.getLocalStorage("lostFoundUserInfo"),e.userFuncInfo=e.$utility.getSessionStorage("userFuncInfo"),e.userFuncCode=e.$utility.getSessionStorage("userFuncCode"),e.getCompanyList(),e.$watch("searchInfo",(function(){clearTimeout(t),t=setTimeout((function(){e.getList(!0)}),200)}),{deep:!0})},mounted:function(){var e=this,t=null;window.onresize=function(){clearTimeout(t),t=setTimeout((function(){e.height=window.innerHeight}),500)}},beforeDestroy:function(){clearInterval(window.recordTime)}},n=o,r=(a("7581"),a("2877")),l=Object(r["a"])(n,i,s,!1,null,null,null);t["default"]=l.exports}}]);
//# sourceMappingURL=chunk-45d5eb98.b15933b6.js.map