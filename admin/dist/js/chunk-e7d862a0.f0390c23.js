(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e7d862a0"],{"3b03":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page"},[i("div",{staticClass:"searchWrap"},[i("div",{staticClass:"search"},[i("table",[i("tr",[i("td",[e._v("\n                          部门:\n                        "),[i("div",{staticStyle:{display:"inline-block"}},[i("Cascader",{staticStyle:{width:"400px"},attrs:{data:e.treeData},model:{value:e.searchInfo.orgids,callback:function(t){e.$set(e.searchInfo,"orgids",t)},expression:"searchInfo.orgids"}})],1)],e._v("\n                        \n                          用户名:\n                        "),[i("Input",{staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入用户名"},model:{value:e.searchInfo.userName,callback:function(t){e.$set(e.searchInfo,"userName",t)},expression:"searchInfo.userName"}})],[i("div",{staticClass:"searchBtnList"},[i("Button",{attrs:{type:"primary",icon:"ios-add-circle"},on:{click:e.showNew}},[e._v("新增")]),i("Button",{attrs:{icon:"ios-refresh-circle"},on:{click:e.reflesh}},[e._v("重置")])],1)]],2)])])])]),i("div",{staticClass:"tableList"},[[i("Table",{attrs:{height:e.height-100,border:"",stripe:"",loading:e.isLoading,columns:e.columnsRealTime,data:e.realTimeDataList},scopedSlots:e._u([{key:"action",fn:function(t){var a=t.row;t.index;return[i("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showEdit(a)}}},[e._v("修改")]),e._v("  \n                ")]}},{key:"status",fn:function(t){var a=t.row;t.index;return[[i("i-switch",{attrs:{size:"large",value:a.status,"true-value":1,"false-value":0},on:{"on-change":function(t){return e.enableOrNot(0==a.status?"1":"0",a)}}},[i("span",{attrs:{slot:"open"},slot:"open"},[e._v("启用")]),i("span",{attrs:{slot:"close"},slot:"close"},[e._v("禁用")])])]]}}])})]],2),i("div",{staticClass:"pageWrap"},[[i("Page",{attrs:{total:e.count,"page-size":50,"page-size-opts":[50,100,150],"show-sizer":"",showTotal:""},on:{"on-change":e.pageSizeChange,"on-page-size-change":e.pageRowChange}})]],2),[i("Modal",{staticClass:"noContentPadding noHeaderModal",attrs:{"mask-closable":!1,width:"30",styles:{top:"5%"},title:"新增/修改账号"},on:{"on-cancel":function(t){e.isDetail=!1}},model:{value:e.isDetail,callback:function(t){e.isDetail=t},expression:"isDetail"}},[i("div",{staticClass:"modalTable"},[i("div",{staticClass:"detail",style:{maxHeight:e.height-100+"px",overflowY:"auto"}},[i("table",[i("tr",[i("td",[i("span",{staticClass:"request"},[e._v("*")]),e._v("所在部门：\n                                "),i("div",[i("Cascader",{attrs:{data:e.treeData},model:{value:e.itemInfo.orgids,callback:function(t){e.$set(e.itemInfo,"orgids",t)},expression:"itemInfo.orgids"}})],1)])]),i("tr",[i("td",[i("span",{staticClass:"request"},[e._v("*")]),e._v("用户名：\n                                "),i("div",[i("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写用户名,可由英文字母、数字组成"},model:{value:e.itemInfo.username,callback:function(t){e.$set(e.itemInfo,"username",t)},expression:"itemInfo.username"}})],1),i("div",{staticClass:"tips"},[e._v("必填，可由英文字母、数字组成")])])]),i("tr",[i("td",[e._v("\n                                昵称：\n                                "),i("div",[i("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写昵称,可以是中文"},model:{value:e.itemInfo.nickname,callback:function(t){e.$set(e.itemInfo,"nickname",t)},expression:"itemInfo.nickname"}})],1),i("div",{staticClass:"tips"},[e._v("可以是中文")])])]),i("tr",[i("td",[i("span",{staticClass:"request"},[e._v("*")]),e._v("密码：\n                                "),i("div",[i("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写登录密码,至少6个字符,最多18个字符"},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),i("div",{staticClass:"tips"},[e._v("必填，至少6个字符,最多18个字符")])])]),i("tr",[i("td",[i("span",{staticClass:"request"},[e._v("*")]),e._v("角色：\n                                "),i("div",[[i("Select",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"选择角色"},model:{value:e.itemInfo.rolename,callback:function(t){e.$set(e.itemInfo,"rolename",t)},expression:"itemInfo.rolename"}},[e._l(e.roleList,(function(t,a){return[i("Option",{key:a,attrs:{value:t.name}},[e._v(e._s(t.name))])]}))],2)]],2),i("div",{staticClass:"tips"},[e._v("非超级管理员，禁止创建与当前角色同级的用户")])])]),i("tr",[i("td",[e._v("\n                                手机号码：\n                                "),i("div",[i("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"手机号码"},model:{value:e.itemInfo.mobile,callback:function(t){e.$set(e.itemInfo,"mobile",t)},expression:"itemInfo.mobile"}})],1)])]),i("tr",[i("td",[e._v("\n                                邮箱：\n                                "),i("div",[i("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"常用邮箱"},model:{value:e.itemInfo.email,callback:function(t){e.$set(e.itemInfo,"email",t)},expression:"itemInfo.email"}})],1)])])])])]),i("div",{staticClass:"modalFooter",attrs:{slot:"footer"},slot:"footer"},[[i("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"default"},on:{click:function(t){e.isDetail=!1}}},[e._v("关闭")]),i("Button",{attrs:{type:"primary",disabled:e.disable},on:{click:e.saveAction}},[e._v("提交")])]],2)])]],2)},n=[],s=(i("a450"),i("fc02"),i("1bc7"),i("897d")),o=i.n(s),r={name:"user",components:{},data:function(){return{userInfo:null,userFuncInfo:null,height:window.innerHeight,isDetail:!1,disable:!1,isLoading:!1,userFuncCode:{},count:0,pageInfo:{pageIndex:1,pageSize:50},searchInfo:{userCode:"",userName:"",orgid:"",orgids:[]},itemInfo:{id:"",email:"",mobile:"",roleid:"",nickname:"",password:"",username:"",orgid:"",orgids:[]},newPassword:"",columnsRealTime:[{align:"center",title:"序号",type:"index",width:60},{title:"账号名",align:"center",key:"username"},{title:"姓名",align:"center",key:"nickname"},{title:"手机号",align:"center",key:"mobile"},{title:"邮箱",align:"center",key:"email"},{title:"角色",align:"center",key:"rolename"},{title:"状态",align:"center",key:"status",slot:"status"},{title:"创建时间",align:"center",key:"create_time"},{align:"center",title:"操作",width:120,slot:"action"}],realTimeDataList:[],roleList:[],treeData:[]}},methods:{pageSizeChange:function(e){var t=this;t.pageInfo.pageIndex=parseInt(e,10),t.getList(!0)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),t.getList(!1)},reflesh:function(){var e=this;e.getList(!0),e.getRoleList(),e.getDepetList()},getList:function(e){var t=this;1==e&&(t.isLoading=!0,t.pageInfo.pageIndex=0),t.axios({method:"get",url:t.$config.action.userList,params:{pageNum:t.pageInfo.pageIndex,pageSize:t.pageInfo.pageSize,orgid:t.searchInfo.orgids[t.searchInfo.orgids.length-1]}}).then((function(e){t.realTimeDataList=e.data.list,t.count=e.data.total,"0"==e.data.code||("9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.msg)),t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},showNew:function(){var e=this;e.itemInfo={id:"",email:"",roleid:"",mobile:"",nickname:"",password:"",username:"",orgids:[],orgid:""},e.isDetail=!0},showEdit:function(e){var t=this,i=[];for(var a in e)t.itemInfo[a]=e[a];t.itemInfo.orgids=[],t.isDetail=!0,t.itemInfo.orgid>=0&&(t.$utility.setDepetList(t.treeData,t.itemInfo.orgid,i),i[0].split(",").forEach((function(e){t.itemInfo.orgids.push(parseInt(e,10))})))},showInfo:function(e){var t=this;for(var i in e)t.itemInfo[i]=e[i];t.isInfo=!0},saveAction:function(){var e=this;e.itemInfo.username.trim().length<2||e.itemInfo.username.trim().length>50?e.$Message.error("用户账号至少2到50位字符"):e.itemInfo.id||!(e.newPassword.trim().length<6||e.newPassword.trim().length>18)?(e.roleList.forEach((function(t){e.itemInfo.rolename==t.name&&(e.itemInfo.roleid=t.id)})),e.disable=!0,e.axios({method:"post",headers:{token:e.userInfo.token},url:e.itemInfo.id?e.$config.action.userEdit:e.$config.action.userAdd,data:{id:e.itemInfo.id||"",email:e.itemInfo.email,mobile:e.itemInfo.mobile,roleid:e.itemInfo.roleid,nickname:e.itemInfo.nickname,password:e.newPassword?o()(e.newPassword):"",username:e.itemInfo.username,orgid:e.itemInfo.orgids[e.itemInfo.orgids.length-1]}}).then((function(t){"0"==t.data.code?(e.$Message.success("提交成功"),e.getList(!1),e.isDetail=!1,e.itemInfo={id:"",email:"",roleid:"",mobile:"",nickname:"",password:"",username:"",orgids:[],orgid:""}):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.msg),e.disable=!1})).catch((function(t){console.log(t),e.disable=!1}))):e.$Message.error("登录密码至少6到18位字符")},deleteAction:function(e){var t=this;t.$Modal.confirm({title:"确定删除"+e.username+"?",onOk:function(){t.axios({method:"post",headers:{token:t.userInfo.token},url:t.$config.action.userDelete,data:{id:e.id}}).then((function(e){"0"==e.data.code?(t.$Message.success("删除成功"),t.getList(!0)):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.msg)})).catch((function(e){console.log(e)}))}})},enableOrNot:function(e,t){var i=this;i.axios({method:"post",headers:{token:i.userInfo.token},url:1==e?i.$config.action.userEnable:i.$config.action.userDisable,data:{id:t.id}}).then((function(e){"0"==e.data.code?(i.$Message.success("修改成功"),i.getList(!1)):"419"==e.data.code?i.$utility.loginTimeOut(i):i.$Message.error(e.data.msg)})).catch((function(e){console.log(e)}))},getRoleList:function(){var e=this;e.axios({method:"get",headers:{token:e.userInfo.token},url:e.$config.action.roleList,params:{pageNum:1,pageSize:1e3}}).then((function(t){e.roleList=t.data.list,"0"==t.data.code?e.roleList=t.data.list:"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.msg)})).catch((function(e){console.log(e)}))},getDepetList:function(e){var t=this;t.axios({method:"get",headers:{token:t.userInfo.token},url:t.$config.action.orgList,params:{pageNum:1,pageSize:1e4}}).then((function(e){function i(e){var t=e;return t.filter((function(e){var i=t.filter((function(t){return e.id==t.pid}));return!(i.length>0)||(e.children=i),0==e.pid}))}t.realTimeDataList=e.data.list,t.count=e.data.total,t.treeData=[],t.realTimeDataList.forEach((function(e,i){t.realTimeDataList[i]["label"]=e.name,t.realTimeDataList[i]["value"]=e.id})),t.treeData=i(t.realTimeDataList),t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},progressing:function(){var e=this;e.disabled=!0},errorUpload:function(e){var t=this;t.disabled=!1,console.log(e)},uploadSuccess:function(e,t,i){var a=this;a.disabled=!1,e.data&&e.data.length>0?console.log(e,t,i):a.$Message.info({content:e.message,duration:0,closable:!0})}},created:function(){var e=this,t=null;e.userInfo=e.$utility.getLocalStorage("userInfo"),e.userFuncInfo=e.$utility.getSessionStorage("userFuncInfo"),e.userFuncCode=e.$utility.getSessionStorage("userFuncCode"),e.getList(!0),e.getRoleList(),e.getDepetList(),e.$watch("searchInfo",(function(){clearTimeout(t),t=setTimeout((function(){e.getList(!0)}),200)}),{deep:!0})},mounted:function(){var e=this,t=null;window.onresize=function(){clearTimeout(t),t=setTimeout((function(){e.height=window.innerHeight}),500)}},beforeDestroy:function(){}},l=r,c=(i("423d"),i("5d22")),d=Object(c["a"])(l,a,n,!1,null,null,null);t["default"]=d.exports},"423d":function(e,t,i){"use strict";i("f91f")},f91f:function(e,t,i){}}]);
//# sourceMappingURL=chunk-e7d862a0.f0390c23.js.map