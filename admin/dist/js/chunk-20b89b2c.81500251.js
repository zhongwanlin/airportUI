(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20b89b2c"],{a54a:function(t,e,a){},f9b2:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("div",{staticClass:"searchWrap"},[a("div",{staticClass:"search"},[a("table",[a("tr",[a("td",[t._v("\n                        设备\n                        "),[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:t.searchInfo.mac_id,callback:function(e){t.$set(t.searchInfo,"mac_id",e)},expression:"searchInfo.mac_id"}},t._l(t.marchineList,(function(e){return a("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],[a("div",{staticClass:"searchBtnList"},[a("Button",{attrs:{type:"primary",icon:"ios-add-circle"},on:{click:t.showNew}},[t._v("新增")]),a("Button",{attrs:{icon:"ios-refresh-circle"},on:{click:t.reflesh}},[t._v("重置")])],1)]],2)])])])]),a("div",{staticClass:"tableList"},[[a("Table",{attrs:{height:t.height-100,border:"",stripe:"",loading:t.isLoading,columns:t.columnsRealTime,data:t.realTimeDataList},scopedSlots:t._u([{key:"action",fn:function(e){var n=e.row;e.index;return[a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.showEdit(n)}}},[t._v("修改")]),t._v("  \n                    "),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(e){return t.deleteAction(n)}}},[t._v("删除")])]}},{key:"macInfos",fn:function(e){var a=e.row;e.index;return[t._l(a.macInfos,(function(e){return[t._v("\n                        "+t._s(e)+"\n                    ")]}))]}},{key:"status",fn:function(e){var n=e.row;e.index;return[[a("i-switch",{attrs:{size:"large",value:n.status,"true-value":1,"false-value":0},on:{"on-change":function(e){return t.enableOrNot(0==n.status?"1":"0",n)}}},[a("span",{attrs:{slot:"open"},slot:"open"},[t._v("启用")]),a("span",{attrs:{slot:"close"},slot:"close"},[t._v("禁用")])])]]}}])})]],2),a("div",{staticClass:"pageWrap"},[[a("Page",{attrs:{total:t.count,"page-size":50,"page-size-opts":[50,100,150],"show-sizer":"",showTotal:""},on:{"on-change":t.pageSizeChange,"on-page-size-change":t.pageRowChange}})]],2),[a("Modal",{staticClass:"noContentPadding noHeaderModal",attrs:{"mask-closable":!1,width:"30",styles:{top:"5%"},title:"角色录入"},on:{"on-cancel":function(e){t.isDetail=!1}},model:{value:t.isDetail,callback:function(e){t.isDetail=e},expression:"isDetail"}},[a("div",{staticClass:"modalTable"},[a("div",{staticClass:"detail"},[a("table",[a("tr",[a("td",[a("span",{staticClass:"request"},[t._v("*")]),t._v("资源名称：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写资源名称"},model:{value:t.itemInfo.name,callback:function(e){t.$set(t.itemInfo,"name",e)},expression:"itemInfo.name"}})],1)])]),a("tr",[a("td",[t._v("\n                                设备：\n                                "),a("div",[a("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:t.itemInfo.macInfos,callback:function(e){t.$set(t.itemInfo,"macInfos",e)},expression:"itemInfo.macInfos"}},t._l(t.marchineList,(function(e){return a("Option",{key:e.id,attrs:{value:e.mac_id+"-"+e.name}},[t._v(t._s(e.name))])})),1)],1)])]),a("tr",[a("td",[a("span",{staticClass:"request"},[t._v("*")]),t._v("图片：\n                                "),a("div",[[a("Upload",{attrs:{multiple:"",headers:{token:t.userInfo.token},action:t.$config.action.setFileUpload,disabled:t.disable,"show-upload-list":t.isShowUploadList,"on-error":t.errorUpload,"on-progress":t.progressing,"on-success":t.uploadSuccess,"on-remove":t.removeFile}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[t._v("上传图片")])],1)]],2),a("div",{staticStyle:{padding:"10px 0"}},[a("Row",{attrs:{gutter:10}},[t._l(t.itemInfo.urls,(function(t,e){return[a("Col",{key:e,attrs:{span:"12"}},[a("div",{key:e},[a("img",{staticStyle:{width:"100%"},attrs:{src:t}})])])]}))],2)],1)])])])])]),a("div",{staticClass:"modalFooter",attrs:{slot:"footer"},slot:"footer"},[[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"default"},on:{click:function(e){t.isDetail=!1}}},[t._v("关闭")]),a("Button",{attrs:{type:"primary",disable:t.disable},on:{click:t.saveAction}},[t._v("提交")])]],2)])]],2)},i=[],o=(a("fc02"),a("a450"),a("1bc7"),{name:"role",components:{},data:function(){return{userInfo:null,height:window.innerHeight,isModalLoading:!1,isDetail:!1,isFunction:!1,isInfo:!1,disable:!1,isLoading:!1,isShowUploadList:!1,count:0,pageInfo:{pageIndex:0,pageSize:50},searchInfo:{macName:"",mac_id:""},itemInfo:{id:0,macInfos:[],name:"",urls:[]},columnsRealTime:[{align:"center",title:"序号",type:"index",width:60},{title:"资源名称",align:"center",key:"name"},{title:"资源路径",align:"center",key:"macInfos",slot:"macInfos"},{align:"center",title:"状态",width:120,slot:"status"},{title:"创建时间",align:"center",key:"create_time"},{title:"更新时间",align:"center",key:"update_time"},{align:"center",title:"操作",width:220,slot:"action"}],realTimeDataList:[],marchineList:[]}},methods:{pageSizeChange:function(t){var e=this;e.pageInfo.pageIndex=parseInt(t,10),e.getList(!0)},pageRowChange:function(t){var e=this;e.pageInfo.pageSize=parseInt(t,10),e.getList(!1)},reflesh:function(){var t=this;t.getList(!0),t.getDeviceList(!0)},getList:function(t){var e=this;1==t&&(e.isLoading=!0,e.pageInfo.pageIndex=0),e.axios({method:"get",headers:{token:e.userInfo.token},url:e.$config.action.emergencyList,params:{pageNum:e.pageInfo.pageIndex,pageSize:e.pageInfo.pageSize,name:e.searchInfo.macName,dep_status:e.searchInfo.mac_id}}).then((function(t){e.realTimeDataList=t.data.list,e.count=t.data.total,"0"==t.data.code?(e.realTimeDataList=t.data.data,e.count=t.data.count):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.msg),e.isLoading=!1})).catch((function(t){console.log(t),e.isLoading=!1}))},showNew:function(){var t=this;t.itemInfo={id:0,macInfos:[],name:"",urls:[]},t.isDetail=!0},showEdit:function(t){var e=this;for(var a in t)e.itemInfo[a]=t[a];e.itemInfo.urls=JSON.parse(t.url);var n=JSON.parse(t.macInfo);e.itemInfo.macInfos=[],n.forEach((function(t){e.itemInfo.macInfos.push(t.mac_id+"-"+t.name)})),console.log(e.itemInfo.macInfos),e.isDetail=!0},saveAction:function(){var t=this,e=[];console.log(t.itemInfo.name),0!=t.itemInfo.name.length?0!=t.itemInfo.macInfos.length?0!=t.itemInfo.urls.length?(t.itemInfo.macInfos.forEach((function(t){var a=t.split("-");e.push({mac_id:a[0],name:a[1]})})),t.disable=!0,t.axios({method:"post",headers:{token:t.userInfo.token},url:t.itemInfo.id?t.$config.action.emergencyEdit:t.$config.action.emergencyAdd,data:{id:t.itemInfo.id||0,macInfos:e,name:t.itemInfo.name,urls:t.itemInfo.urls}}).then((function(e){"0"==e.data.code?(t.$Message.success("提交成功"),t.getList(!1),t.isDetail=!1,t.isShowUploadList=!1,t.itemInfo={id:0,macInfos:[],name:"",urls:[]}):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.msg),t.disable=!1})).catch((function(e){console.log(e),t.disable=!1,t.isShowUploadList=!1}))):t.$Message.error("请上传图片"):t.$Message.error("请选择设备"):t.$Message.error("请输入预案名称")},deleteAction:function(t){var e=this;e.$Modal.confirm({title:"确定删除"+t.name+"?",onOk:function(){e.axios({method:"post",headers:{token:e.userInfo.token},url:e.$config.action.emergencyDelete,data:{id:t.id}}).then((function(t){"0"==t.data.code?(e.$Message.success("删除成功"),e.getList(!0)):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.msg)})).catch((function(t){console.log(t)}))}})},getDeviceList:function(t){var e=this;e.axios({method:"get",headers:{token:e.userInfo.token},url:e.$config.action.marchineList,params:{pageNum:1,pageSize:1e4,area_id:"",dep_status:"",mac_id:"",status:"",version:"",name:""}}).then((function(t){e.marchineList=t.data.list})).catch((function(t){console.log(t)}))},enableOrNot:function(t,e){var a=this;a.axios({method:"post",headers:{token:a.userInfo.token},url:1==t?a.$config.action.emergencyEnable:a.$config.action.emergencyDisable,data:{id:e.id}}).then((function(t){"0"==t.data.code?(a.$Message.success("修改成功"),a.getList(!1)):"419"==t.data.code?a.$utility.loginTimeOut(a):a.$Message.error(t.data.msg)})).catch((function(t){console.log(t)}))},progressing:function(){var t=this;t.disabled=!0},errorUpload:function(){var t=this;t.disabled=!1,console.log(error)},removeFile:function(t,e){var a=this;a.itemInfo.urls=[],e.forEach((function(t){t.response.data&&a.itemInfo.urls.push(a.$config.hostName+t.response.data)}))},uploadSuccess:function(t,e,a){var n=this;n.disabled=!1,console.log(t),t.data&&t.data.length>0?(n.isShowUploadList=!0,n.itemInfo.urls=[],a.forEach((function(t){t.response.data&&n.itemInfo.urls.push(n.$config.hostName+t.response.data)}))):n.$Message.error({content:t.data.result,duration:5})}},created:function(){var t=this,e=null;t.userInfo=t.$utility.getLocalStorage("userInfo"),t.getDeviceList(!0),t.realTimeDataList=[{id:0,name:"资源名称1",create_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,macInfos:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com"]},{id:1,name:"资源名称2",create_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,macInfos:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com"]},{id:2,name:"资源名称3",create_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:t.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,macInfos:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com"]}],t.$watch("searchInfo",(function(){clearTimeout(e),e=setTimeout((function(){t.getList(!0)}),200)}),{deep:!0})},mounted:function(){var t=this,e=null;window.onresize=function(){clearTimeout(e),e=setTimeout((function(){t.height=window.innerHeight}),500)}},beforeDestroy:function(){clearInterval(window.recordTime)}}),s=o,r=(a("fa57"),a("5d22")),c=Object(r["a"])(s,n,i,!1,null,null,null);e["default"]=c.exports},fa57:function(t,e,a){"use strict";a("a54a")}}]);
//# sourceMappingURL=chunk-20b89b2c.81500251.js.map