(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-91dbd6a8"],{"1ed7":function(e,t,a){},7120:function(e,t,a){"use strict";a("1ed7")},a5a9:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page"},[a("div",{staticClass:"searchWrap"},[a("div",{staticClass:"search"},[a("table",[a("tr",[a("td",[e._v("\n                        设备\n                        "),[a("Select",{staticStyle:{width:"200px"},attrs:{clearable:""},model:{value:e.searchInfo.mac_id,callback:function(t){e.$set(e.searchInfo,"mac_id",t)},expression:"searchInfo.mac_id"}},e._l(e.marchineList,(function(t){return a("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])})),1)],[a("div",{staticClass:"searchBtnList"},[a("Button",{attrs:{type:"primary",icon:"ios-add-circle"},on:{click:e.showNew}},[e._v("新增")]),a("Button",{attrs:{icon:"ios-refresh-circle"},on:{click:e.reflesh}},[e._v("重置")])],1)]],2)])])])]),a("div",{staticClass:"tableList"},[[a("Table",{attrs:{height:e.height-100,border:"",stripe:"",loading:e.isLoading,columns:e.columnsRealTime,data:e.realTimeDataList},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.row;t.index;return[a("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showEdit(n)}}},[e._v("修改")]),e._v("  \n                    "),a("Button",{attrs:{type:"error",size:"small"},on:{click:function(t){return e.deleteAction(n)}}},[e._v("删除")])]}},{key:"macInfos",fn:function(t){var a=t.row;t.index;return[e._l(a.macInfos,(function(t){return[e._v("\n                        "+e._s(t.name)+"\n                    ")]}))]}},{key:"status",fn:function(t){var n=t.row;t.index;return[[a("i-switch",{attrs:{size:"large",value:n.status,"true-value":1,"false-value":0},on:{"on-change":function(t){return e.enableOrNot(0==n.status?"1":"0",n)}}},[a("span",{attrs:{slot:"open"},slot:"open"},[e._v("启用")]),a("span",{attrs:{slot:"close"},slot:"close"},[e._v("禁用")])])]]}}])})]],2),a("div",{staticClass:"pageWrap"},[[a("Page",{attrs:{total:e.count,"page-size":50,"page-size-opts":[50,100,150],"show-sizer":"",showTotal:""},on:{"on-change":e.pageSizeChange,"on-page-size-change":e.pageRowChange}})]],2),[a("Modal",{staticClass:"noContentPadding noHeaderModal",attrs:{"mask-closable":!1,width:"30",styles:{top:"5%"},title:"角色录入"},on:{"on-cancel":function(t){e.isDetail=!1}},model:{value:e.isDetail,callback:function(t){e.isDetail=t},expression:"isDetail"}},[a("div",{staticClass:"modalTable"},[a("div",{staticClass:"detail"},[a("table",[a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("预案名称：\n                                "),a("div",[a("Input",{staticStyle:{width:"100%"},attrs:{placeholder:"填写预案名称"},model:{value:e.itemInfo.name,callback:function(t){e.$set(e.itemInfo,"name",t)},expression:"itemInfo.name"}})],1)])]),a("tr",[a("td",[e._v("\n                                设备：\n                                "),a("div",[a("Select",{staticStyle:{width:"100%"},attrs:{multiple:""},model:{value:e.itemInfo.macInfos,callback:function(t){e.$set(e.itemInfo,"macInfos",t)},expression:"itemInfo.macInfos"}},e._l(e.marchineList,(function(t){return a("Option",{key:t.id,attrs:{value:t.mac_id+"-"+t.name}},[e._v(e._s(t.name))])})),1)],1)])]),a("tr",[a("td",[a("span",{staticClass:"request"},[e._v("*")]),e._v("图片：\n                                "),a("div",[[a("Upload",{attrs:{multiple:"",headers:{token:e.userInfo.token},action:e.$config.action.setFileUpload,disabled:e.disable,"show-upload-list":e.isShowUploadList,"on-error":e.errorUpload,"on-progress":e.progressing,"on-success":e.uploadSuccess,"on-remove":e.removeFile}},[a("Button",{attrs:{icon:"ios-cloud-upload-outline"}},[e._v("上传图片")])],1)]],2),a("div",{staticStyle:{padding:"10px 0"}},[a("Row",{attrs:{gutter:10}},[e._l(e.itemInfo.urls,(function(e,t){return[a("Col",{key:t,attrs:{span:"12"}},[a("div",{key:t},[a("img",{staticStyle:{width:"100%"},attrs:{src:e}})])])]}))],2)],1)])])])])]),a("div",{staticClass:"modalFooter",attrs:{slot:"footer"},slot:"footer"},[[a("Button",{staticStyle:{"margin-right":"5px"},attrs:{type:"default"},on:{click:function(t){e.isDetail=!1}}},[e._v("关闭")]),a("Button",{attrs:{type:"primary",disable:e.disable},on:{click:e.saveAction}},[e._v("提交")])]],2)])]],2)},i=[],o=(a("fc02"),a("a450"),a("1bc7"),{name:"role",components:{},data:function(){return{userInfo:null,height:window.innerHeight,isModalLoading:!1,isDetail:!1,isFunction:!1,isInfo:!1,disable:!1,isLoading:!1,isShowUploadList:!1,count:0,pageInfo:{pageIndex:0,pageSize:50},searchInfo:{macName:"",mac_id:""},itemInfo:{id:0,macInfos:[],name:"",urls:[]},columnsRealTime:[{align:"center",title:"序号",type:"index",width:60},{title:"预案名称",align:"center",key:"name"},{title:"设备",align:"center",key:"macInfos",slot:"macInfos"},{title:"创建时间",align:"center",key:"create_time"},{title:"更新时间",align:"center",key:"update_time"},{align:"center",title:"状态",width:120,slot:"status"},{align:"center",title:"操作",width:220,slot:"action"}],realTimeDataList:[],marchineList:[]}},methods:{pageSizeChange:function(e){var t=this;t.pageInfo.pageIndex=parseInt(e,10),t.getList(!0)},pageRowChange:function(e){var t=this;t.pageInfo.pageSize=parseInt(e,10),t.getList(!1)},reflesh:function(){var e=this;e.getList(!0),e.getDeviceList(!0)},getList:function(e){var t=this;1==e&&(t.isLoading=!0,t.pageInfo.pageIndex=0),t.axios({method:"get",headers:{token:t.userInfo.token},url:t.$config.action.emergencyList,params:{pageNum:t.pageInfo.pageIndex,pageSize:t.pageInfo.pageSize,name:t.searchInfo.macName,dep_status:t.searchInfo.mac_id}}).then((function(e){t.realTimeDataList=e.data.list,t.count=e.data.total,"0"==e.data.code?(t.realTimeDataList=e.data.data,t.count=e.data.count):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.msg),t.isLoading=!1})).catch((function(e){console.log(e),t.isLoading=!1}))},showNew:function(){var e=this;e.itemInfo={id:0,macInfos:[],name:"",urls:[]},e.isDetail=!0},showEdit:function(e){var t=this;for(var a in e)t.itemInfo[a]=e[a];t.itemInfo.urls=JSON.parse(e.url);var n=JSON.parse(e.macInfo);t.itemInfo.macInfos=[],n.forEach((function(e){t.itemInfo.macInfos.push(e.mac_id+"-"+e.name)})),console.log(t.itemInfo.macInfos),t.isDetail=!0},saveAction:function(){var e=this,t=[];console.log(e.itemInfo.name),0!=e.itemInfo.name.length?0!=e.itemInfo.macInfos.length?0!=e.itemInfo.urls.length?(e.itemInfo.macInfos.forEach((function(e){var a=e.split("-");t.push({mac_id:a[0],name:a[1]})})),e.disable=!0,e.axios({method:"post",headers:{token:e.userInfo.token},url:e.itemInfo.id?e.$config.action.emergencyEdit:e.$config.action.emergencyAdd,data:{id:e.itemInfo.id||0,macInfos:t,name:e.itemInfo.name,urls:e.itemInfo.urls}}).then((function(t){"0"==t.data.code?(e.$Message.success("提交成功"),e.getList(!1),e.isDetail=!1,e.isShowUploadList=!1,e.itemInfo={id:0,macInfos:[],name:"",urls:[]}):"9003"==t.data.code?e.utility.loginTimeOut(e):e.$Message.error(t.data.msg),e.disable=!1})).catch((function(t){console.log(t),e.disable=!1,e.isShowUploadList=!1}))):e.$Message.error("请上传图片"):e.$Message.error("请选择设备"):e.$Message.error("请输入预案名称")},deleteAction:function(e){var t=this;t.$Modal.confirm({title:"确定删除"+e.name+"?",onOk:function(){t.axios({method:"post",headers:{token:t.userInfo.token},url:t.$config.action.emergencyDelete,data:{id:e.id}}).then((function(e){"0"==e.data.code?(t.$Message.success("删除成功"),t.getList(!0)):"9003"==e.data.code?t.utility.loginTimeOut(t):t.$Message.error(e.data.msg)})).catch((function(e){console.log(e)}))}})},getDeviceList:function(e){var t=this;t.axios({method:"get",headers:{token:t.userInfo.token},url:t.$config.action.marchineList,params:{pageNum:1,pageSize:1e4,area_id:"",dep_status:"",mac_id:"",status:"",version:"",name:""}}).then((function(e){t.marchineList=e.data.list})).catch((function(e){console.log(e)}))},enableOrNot:function(e,t){var a=this;a.axios({method:"post",headers:{token:a.userInfo.token},url:1==e?a.$config.action.emergencyEnable:a.$config.action.emergencyDisable,data:{id:t.id}}).then((function(e){"0"==e.data.code?(a.$Message.success("修改成功"),a.getList(!1)):"419"==e.data.code?a.$utility.loginTimeOut(a):a.$Message.error(e.data.msg)})).catch((function(e){console.log(e)}))},progressing:function(){var e=this;e.disabled=!0},errorUpload:function(){var e=this;e.disabled=!1,console.log(error)},removeFile:function(e,t){var a=this;a.itemInfo.urls=[],t.forEach((function(e){e.response.data&&a.itemInfo.urls.push(a.$config.hostName+e.response.data)}))},uploadSuccess:function(e,t,a){var n=this;n.disabled=!1,console.log(e),e.data&&e.data.length>0?(n.isShowUploadList=!0,n.itemInfo.urls=[],a.forEach((function(e){e.response.data&&n.itemInfo.urls.push(n.$config.hostName+e.response.data)}))):n.$Message.error({content:e.data.result,duration:5})}},created:function(){var e=this,t=null;e.userInfo=e.$utility.getLocalStorage("userInfo"),e.getDeviceList(!0),e.realTimeDataList=[{id:0,macInfos:[{name:"866822030391163"},{name:"866822030391163"}],name:"测试预案1",create_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,urls:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com%2Fuploadfile%2F2018%2F0530%2F20180530010203379.jpg&refer=http%3A%2F%2Fwww.newssoon.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=6b947c9d3c3b74e724825d26bbeb5b25","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fdpic.tiankong.com%2F03%2Fv3%2FQJ7108584720.jpg&refer=http%3A%2F%2Fdpic.tiankong.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=a972bd7f0584a858869a0f9d3662a73d"]},{id:1,macInfos:[{name:"866822030391163"},{name:"866822030391163"}],name:"测试预案2",create_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,urls:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com%2Fuploadfile%2F2018%2F0530%2F20180530010203379.jpg&refer=http%3A%2F%2Fwww.newssoon.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=6b947c9d3c3b74e724825d26bbeb5b25","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fdpic.tiankong.com%2F03%2Fv3%2FQJ7108584720.jpg&refer=http%3A%2F%2Fdpic.tiankong.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=a972bd7f0584a858869a0f9d3662a73d"]},{id:2,macInfos:[{name:"866822030391163"},{name:"866822030391163"}],name:"测试预案3",create_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],update_time:e.$utility.getCurrentTimeInfo(new Date)["formatDate"],status:1,urls:["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fwww.newssoon.com%2Fuploadfile%2F2018%2F0530%2F20180530010203379.jpg&refer=http%3A%2F%2Fwww.newssoon.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=6b947c9d3c3b74e724825d26bbeb5b25","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fdpic.tiankong.com%2F03%2Fv3%2FQJ7108584720.jpg&refer=http%3A%2F%2Fdpic.tiankong.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1617370594&t=a972bd7f0584a858869a0f9d3662a73d"]}],e.$watch("searchInfo",(function(){clearTimeout(t),t=setTimeout((function(){e.getList(!0)}),200)}),{deep:!0})},mounted:function(){var e=this,t=null;window.onresize=function(){clearTimeout(t),t=setTimeout((function(){e.height=window.innerHeight}),500)}},beforeDestroy:function(){clearInterval(window.recordTime)}}),s=o,c=(a("7120"),a("5d22")),r=Object(c["a"])(s,n,i,!1,null,null,null);t["default"]=r.exports}}]);
//# sourceMappingURL=chunk-91dbd6a8.7b5359aa.js.map